
volumes:
  node1-data:
  node2-data:
  node3-data:
  node4-data:
  node5-data:
  node1-logs:
  node2-logs:
  node3-logs:
  node4-logs:
  node5-logs:

x-avalanche-node: &avalanche-node
  image: "avaplatform/avalanchego:${AVALANCHEGO_VERSION}"
  restart: unless-stopped
  command:
    - "/avalanchego/build/avalanchego"
    - "--config-file=/config/config.json"
    - "--genesis-file=/genesis/genesis.json"

services:
  node1:
    <<: *avalanche-node
    container_name: avalanche-node1
    ports:
      - "9650:9650"
      - "9651:9651"
    volumes:
      - ./config/node1/config.json:/config/config.json:ro
      - ./config/node1/staking:/staking:ro
      - ./artifacts/genesis/genesis.json:/genesis/genesis.json:ro
      - node1-data:/data
      - node1-logs:/logs
    networks:
      avalanche:
        ipv4_address: 172.28.0.11

  node2:
    <<: *avalanche-node
    container_name: avalanche-node2
    ports:
      - "9652:9650"
      - "9653:9651"
    volumes:
      - ./config/node2/config.json:/config/config.json:ro
      - ./config/node2/staking:/staking:ro
      - ./artifacts/genesis/genesis.json:/genesis/genesis.json:ro
      - node2-data:/data
      - node2-logs:/logs
    networks:
      avalanche:
        ipv4_address: 172.28.0.12

  node3:
    <<: *avalanche-node
    container_name: avalanche-node3
    ports:
      - "9654:9650"
      - "9655:9651"
    volumes:
      - ./config/node3/config.json:/config/config.json:ro
      - ./config/node3/staking:/staking:ro
      - ./artifacts/genesis/genesis.json:/genesis/genesis.json:ro
      - node3-data:/data
      - node3-logs:/logs
    networks:
      avalanche:
        ipv4_address: 172.28.0.13

  node4:
    <<: *avalanche-node
    container_name: avalanche-node4
    ports:
      - "9656:9650"
      - "9657:9651"
    volumes:
      - ./config/node4/config.json:/config/config.json:ro
      - ./config/node4/staking:/staking:ro
      - ./artifacts/genesis/genesis.json:/genesis/genesis.json:ro
      - node4-data:/data
      - node4-logs:/logs
    networks:
      avalanche:
        ipv4_address: 172.28.0.14

  node5:
    <<: *avalanche-node
    container_name: avalanche-node5
    ports:
      - "9658:9650"
      - "9659:9651"
    volumes:
      - ./config/node5/config.json:/config/config.json:ro
      - ./config/node5/staking:/staking:ro
      - ./artifacts/genesis/genesis.json:/genesis/genesis.json:ro
      - node5-data:/data
      - node5-logs:/logs
    networks:
      avalanche:
        ipv4_address: 172.28.0.15

networks:
  avalanche:
    driver: bridge
    ipam:
      config:
        - subnet: 172.28.0.0/24
